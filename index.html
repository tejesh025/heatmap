<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>LeetCode Heatmap Wallpaper</title>
<style>
  body { margin:0; background:black; }
  canvas { display:none; }
</style>
</head>
<body>

<canvas id="c"></canvas>

<script>
/* ===== SCREEN (Realme 9 SE) ===== */
const W = 1080, H = 2400;
const CELL = 70, GAP = 20;
const START_Y = 850;
const START_X = (W - (7*CELL + 6*GAP)) / 2;

/* ===== COLORS ===== */
const BG = "#000000";
const SOLVED = "#FFFFFF";
const MISSED = "#E53935";
const FUTURE = "#3A3A3A";

/* ===== UTC TIME (LeetCode uses UTC) ===== */
const now = new Date();
const Y = now.getUTCFullYear();
const M = now.getUTCMonth();
const TODAY = now.getUTCDate();

const daysInMonth = new Date(Date.UTC(Y, M+1, 0)).getUTCDate();
let firstDay = new Date(Date.UTC(Y, M, 1)).getUTCDay();
firstDay = (firstDay + 6) % 7; // Monday = 0

/* ===== CANVAS ===== */
const canvas = document.getElementById("c");
canvas.width = W;
canvas.height = H;
const ctx = canvas.getContext("2d");

/* ===== LOAD DATA (LOCAL, NO CORS) ===== */
fetch("./submissionCalendar.json")
  .then(res => res.json())
  .then(calendar => {
    ctx.fillStyle = BG;
    ctx.fillRect(0, 0, W, H);

    let day = 1;
    for (let r = 0; r < 6; r++) {
      for (let c = 0; c < 7; c++) {
        const idx = r * 7 + c;
        if (idx < firstDay || day > daysInMonth) continue;

        const x = START_X + c * (CELL + GAP);
        const y = START_Y + r * (CELL + GAP);
        const epoch = Math.floor(Date.UTC(Y, M, day) / 1000);

        ctx.fillStyle =
          day > TODAY ? FUTURE :
          calendar[epoch] ? SOLVED :
          MISSED;

        ctx.fillRect(x, y, CELL, CELL);
        day++;
      }
    }

    const a = document.createElement("a");
    a.download = "output.png";
    a.href = canvas.toDataURL("image/png");
    a.click();
  })
  .catch(err => {
    console.error("Failed to load submissionCalendar.json", err);
  });
</script>

</body>
</html>
